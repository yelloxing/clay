/*!
*
* clay - Provide more flexible data visualization solutions!
* git+https://github.com/yelloxing/clay.git
* 
* author 心叶
*
* version 1.3.2
* 
* build Sun Jul 29 2018
*
* Copyright yelloxing
* Released under the MIT license
* 
* Date:Sat Nov 10 2018 11:22:22 GMT+0800 (CST)
*/

!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e(t):e(t)}("undefined"!=typeof window?window:this,function(t,c){"use strict";var v=function(t,e){return new v.prototype.init(t,e)};v.prototype.init=function(t,e){this.context=e=e||document;var r,n=a(t,e);for(r=0;r<n.length;r++)this[r]=n[r];return this.selector=t,this.length=n.length,this},v.prototype.init.prototype=v.prototype;var o={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},w={whitespace:"[\\x20\\t\\r\\n\\f]",identifier:"(?:\\\\.|[\\w-]|[^\0-\\xa0])+"},i=["href","title","show","type","role","actuate"];function a(t,e){var r,n=[];if("string"!=typeof t){if(!t||1!==t.nodeType&&11!==t.nodeType&&9!==t.nodeType){if(!t||t.constructor!==Array&&t.constructor!==HTMLCollection&&t.constructor!==NodeList)return t&&t.constructor===v?t:[];for(r=0;r<t.length;r++)!t[r]||1!==t[r].nodeType&&11!==t[r].nodeType&&9!==t[r].nodeType||n.push(t[r]);return n}return[t]}if("*"===(t=(t+"").trim().replace(/[\n\f\r]/g,"")))return e.getElementsByTagName("*");var i=w.whitespace,o=w.identifier,a="\\["+i+"{0,}"+o+"(?:"+i+"{0,}="+i+"{0,}(\\'|\\\"){0,1}"+o+"\\1{0,1}){0,1}"+i+"{0,}\\]";if(new RegExp("^(?:"+o+"){0,1}(?:(?:#|\\.)"+o+"|"+a+"){0,}$").test(t)){var h,u=t.match(new RegExp("#"+o,"g")),s=t.match(new RegExp("\\."+o,"g")),c=t.match(new RegExp("^"+o)),f=t.match(new RegExp(a,"g"));if(u){if(1<u.length)return[];h=(h=document.getElementById((u.shift(0)+"").replace(/^#/,"")))?[h]:[]}else h=e.getElementsByClassName&&s?e.getElementsByClassName((s.shift(0)+"").replace(/^\./,"")):c?e.getElementsByTagName(c.shift(0)):e.getElementsByTagName("*");var l,p,d,g,m=new RegExp("^\\["+i+"{0,}("+o+")(?:"+i+"{0,}="+i+"{0,}(?:\\'|\\\"){0,1}("+o+")(?:\\'|\\\"){0,1}){0,1}"+i+"{0,}\\]$");for(r=0;r<h.length;r++)if(g=!0,!(c&&0<c.length&&(c[0]+"").toUpperCase()!==(h[r].tagName+"").toUpperCase())){for(l=" "+h[r].getAttribute("class")+" ",p=0;g&&s&&p<s.length;p++)if(l.search(" "+(s[p]+"").replace(/\./,"")+" ")<0){g=!1;break}for(p=0;g&&f&&p<f.length;p++)if(l=m.exec(f[p]),null===(d=h[r].getAttribute(l[1]))||l[2]&&d!=l[2]){g=!1;break}g&&n.push(h[r])}return n}try{return[y(t)]}catch(t){return[]}}function y(t){var e=document.createElementNS(o.svg,"svg");new RegExp("^"+w.identifier+"$").test(t)&&(t="<"+t+"></"+t+">"),e.innerHTML=t;var r,n,i=e.childNodes;for(r=0;r<i.length;r++)if(1===i[r].nodeType||9===i[r].nodeType||11===i[r].nodeType){n=i[r];break}if("canvas"==n.tagName||/[A-Z]/.test(n.tagName))for((e=document.createElement("div")).innerHTML=t,i=e.childNodes,r=0;r<i.length;r++)if(1===i[r].nodeType||9===i[r].nodeType||11===i[r].nodeType){n=i[r];break}return n}v.prototype.find=function(t){if(this.length<=0)return v();var e,r=v(),n=a(t,this[0]);for(r.selector=t,e=0;e<n.length;e++)r[e]=n[e],r.length+=1;return r},v.prototype.eq=function(t){return this.length<=t?new v:new v(this[t])},v.prototype.appendTo=function(t){var e,r,n=v(t);for(e=0;e<n.length;e++)for(r=0;r<this.length;r++)n[e].appendChild(this[r]);return this},v.prototype.remove=function(){var t;for(t=0;t<this.length;t++)this[t].parentNode.removeChild(this[t]);return this},v.prototype.refresh=function(){var t,e=a(this.selector,this.context),r=this.length;for(t=this.length=0;t<e.length;t++)this[t]=e[t],this.length+=1;for(;t<r;t++)delete this[t];return this},v.prototype.attr=function(t,e){if(null==e||e==c)return 0<this.length?this[0].getAttribute(t):c;var r,n;for(r=0;r<this.length;r++)n="function"==typeof e?e(this[r]._data,r,this.eq(r)):e,/[A-Z]/.test(this[r].tagName)&&0<=i.indexOf(t)?this[r].setAttributeNS(o.xlink,"xlink:"+t,n):this[r].setAttribute(t,n);return this},v.prototype.css=function(t,e){if(arguments.length<=1&&"object"!=typeof t){if(this.length<1)return c;var r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(this[0],null):this[0].currentStyle;return"string"==typeof t?r.getPropertyValue(t):r}var n,i;if(0<this.length)if("object"==typeof t)for(i in t)for(n=0;n<this.length;n++)this[n].style[i]="function"==typeof e?e(this[n]._data,n,i,t[i]):t[i];else for(n=0;n<this.length;n++)this[n].style[t]="function"==typeof e?e(this[n]._data,n):e;return this},v.prototype.datum=function(t,e){if(null===t||t===c)return 0<this.length?this[0]._data:c;var r;for(r=0;r<this.length;r++)t="function"==typeof e?e(t,r):t,this[r]._data=t;return this},v.prototype.data=function(t,e){var r,n=[];if(t&&t.constructor===Array){var i=v();for(i.selector=this.selector,r=0;r<t.length&&r<this.length;r++)this[r]._data="function"==typeof e?e(t[r],r):t[r],i[r]=this[r],i.length+=1;for(i._enter=[];r<t.length;r++)i._enter.push("function"==typeof e?e(t[r],r):t[r]);for(i._exit=[];r<this.length;r++)i._exit.push(this[r]);return i}for(r=0;r<this.length;r++)n[r]=this[r]._data;return n},v.prototype.enter=function(t){var e,r,n=v();for(n.selector=this.selector,e=0;this._enter&&e<this._enter.length;e++)(r=y(t))._data=this._enter[e],n[e]=r,n.length+=1;return delete this._enter,n},v.prototype.exit=function(){var t,e=v();for(e.selector=this.selector,t=0;this._exit&&t<this._exit.length;t++)e[t]=this._exit[t],e.length+=1;return delete this._exit,e},v.prototype.bind=function(t,e){var r;if(window.attachEvent)for(r=0;r<this.length;r++)this[r].attachEvent("on"+t,e);else for(r=0;r<this.length;r++)this[r].addEventListener(t,e,!1);return this},v.prototype.unbind=function(t,e){var r;if(window.detachEvent)for(r=0;r<this.length;r++)this[r].detachEvent("on"+t,e);else for(r=0;r<this.length;r++)this[r].removeEventListener(t,e,!1);return this},v.prototype.position=function(t){var e=this[0].getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}};var u={timers:[],interval:13,speeds:400,timerId:null};v.animation=function(e,t,r){u.timer(function(t){e(t)},t,r)},u.timer=function(t,e,r){if("function"!=typeof t)throw new Error("tick is required!");(e="number"==typeof e?e:u.speeds)<0&&(e=-e),u.timers.push({createTime:new Date,tick:t,duration:e,callback:r}),u.start()},u.start=function(){u.timerId||(u.timerId=setInterval(u.tick,u.interval))},u.tick=function(){var t,e,r,n,i,o,a,h=u.timers;for(u.timers=[],e=u.timers.length=0;e<h.length;e++)t=(i=h[e]).createTime,r=i.tick,o=i.duration,n=i.callback,!1,1<=(a=(+new Date-t)/o)&&!0,r(a=1<a?1:a),a<1?u.timers.push(i):n&&n();u.timers.length<=0&&u.stop()},u.stop=function(){u.timerId&&(clearInterval(u.timerId),u.timerId=null)},v.color=function(t){var e=v("head").css("color",t).css("color").replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+w.whitespace));return[+e[0],+e[1],+e[2],e[3]==c?1:+e[3]]},v.loop=function(t,e){var r,n=0;for(r in t)e(t[r],r,n++);return v};var s=function(t,e,r){t.beginPath(),t.fillStyle=e,r(t),t.fill()};function h(t){if(t&&t.constructor===CanvasRenderingContext2D)return t;var e=v(t);return 0<e.length?e[0].getContext("2d"):void 0}v.prototype.region=function(){var i={},t=document.createElement("canvas"),r=[0,0,0],n="r";t.setAttribute("width",this[0].offsetWidth),t.setAttribute("height",this[0].offsetHeight);var o=this,a=t.getContext("2d"),h={drawer:function(t,e){return i[t]==c&&(i[t]={r:function(){return r[0]+=1,n="g","rgb("+r[0]+","+r[1]+","+r[2]+")"},g:function(){return r[1]+=1,n="b","rgb("+r[0]+","+r[1]+","+r[2]+")"},b:function(){return r[2]+=1,n="r","rgb("+r[0]+","+r[1]+","+r[2]+")"}}[n]()),s(a,i[t],e),h},erase:function(t){return s(a,"rgb(0,0,0)",t),h},getRegion:function(t){var e,r=o.position(t);r.x-=o.css("border-left-width").replace("px",""),r.y-=o.css("border-top-width").replace("px","");var n=a.getImageData(r.x-.5,r.y-.5,1,1).data;for(e in i)if("rgb("+n[0]+","+n[1]+","+n[2]+")"==i[e])return[e,r.x,r.y];return c}};return h},v.prototype.painter=function(){if(0<this.length&&"CANVAS"!=this[0].nodeName&&"canvas"!=this[0].nodeName)throw new Error("canvas is not function");return h(this)},v.prototype.layer=function(){if(0<this.length&&"CANVAS"!=this[0].nodeName&&"canvas"!=this[0].nodeName)throw new Error("layer is not function");var e=h(this),r=[],n={},i=this[0].clientWidth,o=this[0].clientHeight,a={painter:function(t){return n[t]&&n[t].constructor===CanvasRenderingContext2D||(r.push(document.createElement("canvas")),r[r.length-1].setAttribute("width",i),r[r.length-1].setAttribute("height",o),n[t]=r[r.length-1].getContext("2d")),n[t]},clean:function(t){return t.clearRect(0,0,i,o),a},update:function(){if(e&&e.constructor===CanvasRenderingContext2D){var t;for(e.clearRect(0,0,i,o),e.save(),t=0;t<r.length;t++)e.drawImage(r[t],0,0,i,o,0,0,i,o);e.restore()}return a}};return a},v.prototype.webgl=function(t){if(0<this.length&&"CANVAS"!=this[0].nodeName&&"canvas"!=this[0].nodeName)throw new Error("Webgl is not a function!");return function(t,e){if(t&&t.constructor===WebGLRenderingContext)return t;var r,n=v(t),i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],o=null;if(0<n.length)for(r=0;r<i.length;r++){try{o=n[0].getContext(i[r],e)}catch(t){}if(o)break}return o}(this,t)};var d=function(t,e){var r,n,i=[];for(r=0;r<4;r++)for(n=0;n<e.length/4;n++)i[4*n+r]=t[r]*e[4*n]+t[r+4]*e[4*n+1]+t[r+8]*e[4*n+2]+t[r+12]*e[4*n+3];return i};v.Matrix4=function(t){var l=t||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p={move:function(t,e,r,n){return l=d(function(t,e,r,n){n=n||0;var i=Math.sqrt(e*e+r*r+n*n);return[1,0,0,0,0,1,0,0,0,0,1,0,e*t/i,r*t/i,n*t/i,1]}(t,e,r,n),l),p},rotate:function(t,e,r,n,i,o,a){var h,u,s,c=function(t,e,r,n,i,o){if("number"!=typeof t||"number"!=typeof e)throw new Error("a1 and b1 is required!");if("number"!=typeof r?(r=0,n=t,i=e,o=1):"number"==typeof n&&"number"==typeof i&&"number"==typeof o||(n=t,i=e,o=r,r=e=t=0),t==n&&e==i&&r==o)throw new Error("It's not a legitimate ray!");var a=Math.sqrt((n-t)*(n-t)+(i-e)*(i-e)),h=0!=a?(i-e)/a:1,u=0!=a?(n-t)/a:0,s=(n-t)*u+(i-e)*h,c=o-r,f=Math.sqrt(s*s+c*c),l=0!=f?c/f:1,p=0!=f?s/f:0;return[[h,l*u,u*p,0,-u,h*l,h*p,0,0,-p,l,0,e*u-t*h,r*p-t*u*l-e*h*l,-t*u*p-e*h*p-r*l,1],[h,-u,0,0,l*u,l*h,-p,0,u*p,h*p,l,0,t,e,r,1]]}(e,r,n,i,o,a);return l=d(d(d(c[1],(h=t,u=Math.sin(h),[s=Math.cos(h),u,0,0,-u,s,0,0,0,0,1,0,0,0,0,1])),c[0]),l),p},scale:function(t,e,r,n,i,o){var a,h,u,s,c,f;return l=d([a=t,0,0,0,0,h=e,0,0,0,0,u=r,0,(s=(s=n)||0)-s*a,(c=(c=i)||0)-c*h,(f=(f=o)||0)-f*u,1],l),p},multiply:function(t,e){return l=e?d(l,t):d(t,l),p},use:function(t,e,r,n){var i=d(l,[t,e,r=r||0,n=n||1]);return i[0]=Math.round(1e14*i[0])/1e14,i[1]=Math.round(1e14*i[1])/1e14,i[2]=Math.round(1e14*i[2])/1e14,i},value:function(){return l}};return p},v.hermite=function(){var u={u:.5},s=function(t){if(u.MR){var e=(t-u.a)/(u.b-u.a),r=e*e;return(e*r*u.MR[0]+r*u.MR[1]+e*u.MR[2]+u.MR[3])*(u.b-u.a)}throw new Error("You shoud first set the position!")};return s.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return u.u=.5*(1-t),s},s.setP=function(t,e,r,n,i,o){if(!(t<r))throw new Error("The point position should be increamented!");u.a=t,u.b=r;var a=u.u*i,h=u.u*o;return e/=r-t,n/=r-t,u.MR=[2*e-2*n+a+h,3*n-3*e-2*a-h,a,e],s},s},v.cardinal=function(){var e,i={t:0},o=function(t){if(i.hs){for(e=-1;e+1<i.hs.x.length&&(t>i.hs.x[e+1]||-1==e&&t>=i.hs.x[e+1]);)e+=1;if(-1==e||e>=i.hs.h.length)throw new Error("Coordinate crossing!");return i.hs.h[e](t)}throw new Error("You shoud first set the position!")};return o.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return i.t=t,o},o.setP=function(t){i.hs={x:[],h:[]};var e,r,n=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]);for(i.hs.x[0]=t[0][0],e=1;e<t.length;e++){if(t[e][0]<=t[e-1][0])throw new Error("The point position should be increamented!");i.hs.x[e]=t[e][0],r=e<t.length-1?(t[e+1][1]-t[e-1][1])/(t[e+1][0]-t[e-1][0]):(t[e][1]-t[e-1][1])/(t[e][0]-t[e-1][0]),i.hs.h[e-1]=v.hermite().setU(i.t).setP(t[e-1][0],t[e-1][1],t[e][0],t[e][1],n,r),n=r}return o},o};var m=function(t,e,r,n){var i=Math.cos(t),o=Math.sin(t);return[e*i-r*o,e*o+r*i,n]};v.map=function(){var d,g={c:[107,36],s:1},r=function(t,e){var r,n,i,o,a,h,u,s,c,f,l,p;return r=(360-e)/180*Math.PI,n=100*g.s,o=i=0,a=Math.cos(r),h=Math.sin(r),d=[o*h+n*a,i,o*a-n*h],d=m(t/180*Math.PI,d[0],d[1],d[2]),d=m((90-g.c[0])/180*Math.PI,d[0],d[1],d[2]),u=(90-g.c[1])/180*Math.PI,s=d[0],c=d[1],f=d[2],l=Math.cos(u),p=Math.sin(u),[-(d=[s,c*l-f*p,c*p+f*l])[0],d[1],d[2]]};return r.scale=function(t){return"number"==typeof t&&(g.s=t),r},r.center=function(t,e){return"number"==typeof t&&"number"==typeof e&&(g.c=[t,e]),r},r},v.svg={},v.canvas={};var r=function(a){var h={c:[0,0],r:[100,140]},r=function(t,e,r,n){"number"!=typeof r&&(r=h.r[0]),"number"!=typeof n&&(n=h.r[1]);var i,o=[];return i=m(t,r,0,0),o[0]=i[0],o[1]=i[1],i=m(e,i[0],i[1],0),o[2]=i[0],o[3]=i[1],i=m(t,n,0,0),o[4]=i[0],o[5]=i[1],i=m(e,i[0],i[1],0),o[6]=i[0],o[7]=i[1],a(h.c[0],h.c[1],r,n,t,t+e,o[0]+h.c[0],o[1]+h.c[1],o[4]+h.c[0],o[5]+h.c[1],o[2]+h.c[0],o[3]+h.c[1],o[6]+h.c[0],o[7]+h.c[1])};return r.setRadius=function(t,e){return h.r=[t,e],r},r.setCenter=function(t,e){return h.c=[t,e],r},r};v.svg.arc=function(){return r(function(t,e,r,n,i,o,a,h,u,s,c,f,l,p){var d=o-i>Math.PI?1:0,g="M"+a+" "+h;return g+="A"+r+" "+r+" 0 "+d+" 1 "+c+" "+f,g+="L"+l+" "+p,g+="A"+n+" "+n+" 0 "+d+" 0 "+u+" "+s,g+="L"+a+" "+h})},v.canvas.arc=function(t,e){var d=function(t,e,r,n){var i,o=r(n);if(o._painter=h(t),e)for(i in e)o._painter[i]=e[i];return o.painter=function(t){return o._painter=h(t),o},o.config=function(t){for(i in t)o._painter[i]=t[i];return o},o}(t,e,r,function(t,e,r,n,i,o,a,h,u,s,c,f,l,p){return d._painter.beginPath(),d._painter.moveTo(a,h),d._painter.arc(t,e,r,i,o,!1),d._painter.lineTo(l,p),d._painter.arc(t,e,n,o,i,!0),d._painter.lineTo(a,h),d._painter.fill(),d._painter});return d},v.treeLayout=function(){var a,r,u={e:{}},o=function(){var i=[],o=0;!function t(e,r){var n;for(n=0;n<e.children.length;n++)t(a[e.children[n]],r+1);(a[e.id].left=r+.5,0==n)?(i[r]==c&&(i[r]=-.5),i[r-1]==c&&(i[r-1]=-.5),a[e.id].top=i[r]+1,i[r]+1+.5*(a[e.pid].children.length-1)-1<i[r-1]&&(a[e.id].top=i[r-1]+1-.5*(a[e.pid].children.length-1))):a[e.id].top=.5*(a[e.children[0]].top+a[e.children[n-1]].top);i[r]=a[e.id].top,a[e.id].top+.5>o&&(o=a[e.id].top+.5)}(a[r],0),u.e.drawer(a,r,o)},h=function(o){var a,t,h={},e=u.e.root(o);return a=t=u.e.id(e),h[a]={data:e,pid:null,id:a,children:[],show:!0},function t(e,r){var n,i=u.e.child(e,o);for(n=0;i&&n<i.length;n++)a=u.e.id(i[n]),h[r].children.push(a),h[a]={data:i[n],pid:r,id:a,children:[],show:!0},t(i[n],a)}(e,a),[t,h]},s=function(t){var e=h(t);return a=e[1],r=e[0],o(),s};return s.bind=function(t,e,r){return u.e[t]=e,s},s.add=function(t,e,r){var n,i=h(e);for(n in i[1][i[0]].pid=t,a[t].children.push(i[0]),i[1])a[n]=i[1][n];return r||o(),s},s.delete=function(t,e){var r=a[a[t].pid].children.indexOf(t);return-1<r&&a[a[t].pid].children.splice(r,1),function t(e){var r;for(r=0;r<a[e].children.length;r++)t(a[a[e].children[r]].id);delete a[e]}(t),e||o(),s},s.toggle=function(t,e,r){var n=a[a[t].pid].children.indexOf(t);return-1<n&&"show"!=r?(a[a[t].pid].children.splice(n,1),a[t]._index=n):"hidden"!=r&&a[a[t].pid].children.splice(a[t]._index,0,t),e||o(),s},s.update=function(){return o(),s},s};var f=function(t,e,r){var n=t.createShader(e);if(null==n)throw new Error("Unable to create shader!");if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Failed to compile shader:"+t.getShaderInfoLog(n));return n};return v.useShaders=function(t,e,r){var n=f(t,t.VERTEX_SHADER,e),i=f(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,i),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error("Failed to link program: "+t.getProgramInfoLog(o));return t.useProgram(o),o},v.author="心叶",v.email="yelloxing@gmail.com",v.version="1.3.2",t.clay=t.$$=v,v});